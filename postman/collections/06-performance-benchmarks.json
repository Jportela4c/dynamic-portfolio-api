{
  "info": {
    "_postman_id": "performance-benchmarks-v1",
    "name": "06 - Performance Benchmarks",
    "description": "Response time benchmarks for all API endpoints to ensure performance SLAs are met",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "01 - Authentication Performance",
      "item": [
        {
          "name": "OAuth2 Token Generation < 1000ms",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Response time < 1000ms\", () => {",
                  "    pm.expect(pm.response.responseTime).to.be.below(1000);",
                  "});",
                  "",
                  "pm.test(\"Token generated successfully\", () => {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(pm.response.json()).to.have.property('access_token');",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.environment.set('accessToken', pm.response.json().access_token);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "grant_type",
                  "value": "client_credentials"
                },
                {
                  "key": "client_id",
                  "value": "portfolio-api-client"
                },
                {
                  "key": "client_secret",
                  "value": "portfolio-secret-2024"
                },
                {
                  "key": "scope",
                  "value": "read write"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/oauth2/token",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "oauth2", "token"]
            }
          }
        }
      ]
    },
    {
      "name": "02 - Simulation Performance",
      "item": [
        {
          "name": "Investment Simulation < 500ms",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Response time < 500ms\", () => {",
                  "    pm.expect(pm.response.responseTime).to.be.below(500);",
                  "});",
                  "",
                  "pm.test(\"Simulation successful\", () => {",
                  "    pm.response.to.have.status(200);",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('produtoValidado');",
                  "    pm.expect(json).to.have.property('resultadoSimulacao');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tipoProduto\": \"CDB\",\n  \"valor\": 10000,\n  \"prazo\": 12\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/simular-investimento",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "simular-investimento"]
            }
          }
        }
      ]
    },
    {
      "name": "03 - Risk Profile Performance",
      "item": [
        {
          "name": "Risk Profile Calculation < 1000ms",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Response time < 1000ms (includes OFB call)\", () => {",
                  "    pm.expect(pm.response.responseTime).to.be.below(1000);",
                  "});",
                  "",
                  "pm.test(\"Profile calculated successfully\", () => {",
                  "    pm.response.to.have.status(200);",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('perfil');",
                  "    pm.expect(json).to.have.property('pontuacao');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/perfil-risco/1",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "perfil-risco", "1"]
            }
          }
        }
      ]
    },
    {
      "name": "04 - Product Recommendations Performance",
      "item": [
        {
          "name": "Product Recommendations < 200ms",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Response time < 200ms\", () => {",
                  "    pm.expect(pm.response.responseTime).to.be.below(200);",
                  "});",
                  "",
                  "pm.test(\"Products retrieved successfully\", () => {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(pm.response.json()).to.be.an('array');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/produtos-recomendados/CONSERVADOR",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "produtos-recomendados", "CONSERVADOR"]
            }
          }
        }
      ]
    },
    {
      "name": "05 - Investment History Performance",
      "item": [
        {
          "name": "Investment History < 300ms",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Response time < 300ms\", () => {",
                  "    pm.expect(pm.response.responseTime).to.be.below(300);",
                  "});",
                  "",
                  "pm.test(\"History retrieved successfully\", () => {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(pm.response.json()).to.be.an('array');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/investimentos/1",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "investimentos", "1"]
            }
          }
        }
      ]
    },
    {
      "name": "06 - Simulations List Performance",
      "item": [
        {
          "name": "Simulations List < 300ms",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Response time < 300ms\", () => {",
                  "    pm.expect(pm.response.responseTime).to.be.below(300);",
                  "});",
                  "",
                  "pm.test(\"List retrieved successfully\", () => {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(pm.response.json()).to.be.an('array');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/simulacoes",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "simulacoes"]
            }
          }
        }
      ]
    },
    {
      "name": "07 - Aggregated Simulations Performance",
      "item": [
        {
          "name": "Aggregated Simulations < 300ms",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Response time < 300ms\", () => {",
                  "    pm.expect(pm.response.responseTime).to.be.below(300);",
                  "});",
                  "",
                  "pm.test(\"Aggregations retrieved successfully\", () => {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(pm.response.json()).to.be.an('array');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/simulacoes/por-produto-dia",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "simulacoes", "por-produto-dia"]
            }
          }
        }
      ]
    },
    {
      "name": "08 - Telemetry Performance",
      "item": [
        {
          "name": "Telemetry < 100ms",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Response time < 100ms\", () => {",
                  "    pm.expect(pm.response.responseTime).to.be.below(100);",
                  "});",
                  "",
                  "pm.test(\"Telemetry retrieved successfully\", () => {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(pm.response.json()).to.be.an('array');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/telemetria",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "telemetria"]
            }
          }
        }
      ]
    }
  ]
}
